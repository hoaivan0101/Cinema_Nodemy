<!DOCTYPE html>
<html>

<head>
  <title>WEB CINEMA</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./public/stylesheets/GRID.css">
  <link rel="stylesheet" href="./public/stylesheets/index.css">
  <link rel="stylesheet" href="./public/stylesheets/bootstrap-4.5.0-dist/css/bootstrap.css">
  <script src="../public/javascripts/jquery-3.5.1.min.js"></script>
</head>

<body>
  <div class="header">
    <label class="findfilm" for="findfilm">Tìm phim</label>
    <input type="checkbox" name="findfilm" id="findfilm" hidden>
    <label class="header__overlay" for="findfilm"></label>
    <div class="header__findfilm text-center">
      <input type="text" name="q" id="idfind" placeholder="Nhập tên phim...">
      <div class="namequery"></div>
    </div>
    <!-- ///// -->
    <!-- <input type="text" name="q" id="idfind">
    <div class="namequery"></div> -->
  </div>


  <div class="grid wide">
    <div class="row">
      <div class="content">

      </div>
    </div>
  </div>
</body>
<script>
  $.ajax({
    url: '/films',
    type: 'GET'
  })
    .then(data => {
      console.log(data);
      for (let i = 0; i <= 5; i++) {
        loaddata(i, data);
      }
      i = 3;
      $(window).scroll(function () {
        if ($(window).scrollTop() + 20 >= $(document).height() - $(window).height()) {
          loaddata(i, data); i++;
        }
      });
      // FIND
      $('#idfind').keyup(function () {
        var keyQ = $(this).val();
        var result = data.filter(function (item) {
          return item.movieTitle.toLowerCase().indexOf(keyQ.toLowerCase()) > -1;
        })
        $('.namequery').html('');
        for (i of result) { $('.namequery').append(`<div><img style="width:30px"src="${i.moviePicture}"><a href="/films/${i._id}">${i.movieTitle}<a/></div>`) }
      });
    })



  function loaddata(i, data) {
    $('.content').append(` <div class="main flex">
          <div><a href="/films/${data[i]._id}"><img class="main__img--lists" src="${data[i].moviePicture}" alt=""></a></div>
          <div class="main_right">
            <ul>
              <li class="main_right_lists flex"><span class="main_right_lists_left">Tên Phim</span>
                <div class="main_right_lists_right">${data[i].movieTitle}</div></li>
              <li class="main_right_lists flex"><span class="main_right_lists_left">Thời lượng</span><span
                  class="main_right_lists_right">${data[i].movieLength}</span></li>
              <li class="main_right_lists flex"><span class="main_right_lists_left">Quốc Gia</span><span
                  class="main_right_lists_right">${data[i].movieCountry}</span></li>
              <li class="main_right_lists flex"><span class="main_right_lists_left">Diễn Viên</span><span
                  class="main_right_lists_right">${data[i].movieActor}</span></li>
              <li class="main_right_lists flex"><span class="main_right_lists_left">Ngày khởi chiếu</span><span
                  class="main_right_lists_right">${data[i].movieOpenDate}</span></li>
            </ul>
          </div>
        </div>`)
  }
</script>

</html>